# Plan: JSON Schema

## Goal

Provide formal JSON Schemas for the JSON output of various CLI commands and the configuration file. This improves developer experience by allowing programmatic validation and better integration with other tools.

## Requirements

1. **Command**: `fext schema <type>`
    * Types: `config`, `manifest`, `audit`, `risk`, `scan`, `history`.
    * Output: Prints the JSON Schema (Draft 7 or 2020-12) to stdout.
2. **Implementation**:
    * Use `pydantic` models to define the structures (if not already used).
    * Or manually define schemas in `src/fetchext/schemas/`.
    * Since we don't use `pydantic` currently (trying to keep dependencies minimal), we might need to define them manually or use a lightweight helper.
    * Actually, `dataclasses` are used. We can generate schemas from dataclasses using a helper.
3. **Integration**:
    * Add `schema` subcommand to `cli.py`.
    * Create `src/fetchext/schemas.py` to hold or generate schemas.

## Implementation Steps

1. **Create `src/fetchext/schemas.py`**:
    * Define schemas for:
        * `Config` (for `config.toml`)
        * `Manifest` (for `inspect`)
        * `AuditReport` (for `audit`)
        * `RiskReport` (for `risk`)
        * `ScanReport` (for `scan`)
        * `HistoryEntry` (for `history`)
    * Implement `get_schema(type)` function.
2. **Update `src/fetchext/cli.py`**:
    * Add `schema` subcommand.
3. **Tests**:
    * Verify schemas are valid JSON.
    * Verify output matches schema (optional, but good).

## Schema Definitions (Draft)

* **Config**: Structure of `config.toml`.
* **Manifest**: Standard WebExtension manifest structure.
* **AuditReport**: Structure returned by `ExtensionAuditor`.
* **RiskReport**: Structure returned by `RiskAnalyzer`.

## Note

Since we avoid heavy dependencies, we will define schemas as Python dictionaries (JSON objects) directly or use a simple dataclass-to-schema generator if feasible. Given the complexity, manual definition or simple helper is preferred.
