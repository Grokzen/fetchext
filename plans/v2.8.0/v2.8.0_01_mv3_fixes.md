# Plan: Manifest V3 Migration Fixes

## 1. Introduction
The `fext migrate` command (v2.0.0) has edge cases, particularly with `web_accessible_resources`. MV3 requires a specific structure (objects with `resources` and `matches`), whereas MV2 was a simple list of strings.

## 2. Objectives
- Fix `web_accessible_resources` conversion.
- Handle other MV3 edge cases (e.g., `action` vs `browser_action` unification nuances).

## 3. Implementation Details

### 3.1. Logic Update
- In `src/fetchext/core/migrator.py`:
    - When converting `web_accessible_resources`:
        - If it's a list of strings (MV2), convert to `[{ "resources": [...], "matches": ["<all_urls>"] }]` (or try to infer matches if possible, otherwise default to permissive).
- Check for `background.scripts` -> `background.service_worker`. Ensure the script is compatible (this is hard, but at least the manifest entry should be correct).

### 3.2. Validation
- Run the migrated manifest against a schema validator if possible.

## 4. Verification
- **Test**: Migrate an MV2 extension with `web_accessible_resources`.
- **Assert**: Resulting `manifest.json` has the correct MV3 object structure.
