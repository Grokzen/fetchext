# Plan: Config File Support (v0.5.0)

## Goal

Allow users to configure default settings via a TOML configuration file.

## Specification

- **Format**: TOML.
- **Location**: `~/.config/fext/config.toml` (respects `XDG_CONFIG_HOME`).
- **Library**: `tomllib` (Python 3.11+ standard library).
- **Settings**:
  - `general.download_dir`: Default output directory.
  - `batch.workers`: Default number of workers for batch downloads.
  - `general.save_metadata`: Boolean (default false).
  - `general.extract`: Boolean (default false).

## Implementation Plan

1. **Create `src/fetchext/config.py`**:
    - Function `load_config() -> dict`:
        - Determine config path.
        - If exists, read and parse with `tomllib`.
        - Return dict (or flattened dict).
    - Define default config path logic.

2. **Update `src/fetchext/cli.py`**:
    - In `main()` or `parse_args()`:
        - Load config.
        - Update `argparse` defaults using config values.
        - This ensures CLI args override config, and config overrides hardcoded defaults.

3. **Testing**:
    - Create `tests/unit/test_config.py`.
    - Mock filesystem to test loading from different paths.
    - Verify precedence (CLI > Config > Default).

## Files to Modify

- `src/fetchext/config.py` (New)
- `src/fetchext/cli.py`
- `tests/unit/test_config.py` (New)

## Verification

- Run `make test`.
