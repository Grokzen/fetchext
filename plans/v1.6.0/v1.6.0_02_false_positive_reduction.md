# Plan: False Positive Reduction (v1.6.0 Item 2)

## Goal

Reduce false positives in the `SecretScanner`, particularly for the "Generic API Key" pattern, to make the security audit more reliable.

## Current State

- `SecretScanner` uses a list of regex patterns.
- "Generic API Key" pattern is: `r"(?i)(api_key|apikey|secret|token)\s*[:=]\s*['\"]([a-zA-Z0-9_\-]{20,})['\"]"`
- This matches many non-secret strings (e.g., placeholders, long variable names, CSS classes in some contexts).

## Proposed Changes

1. **Refine Generic Regex**:
    - Exclude common placeholder values (e.g., `YOUR_API_KEY`, `REPLACE_ME`).
    - Ensure the matched string has high entropy (randomness) rather than just being long.
2. **Entropy Validation**:
    - Implement a helper `_is_high_entropy(string)` method.
    - Apply this check to "Generic API Key" matches.
3. **Allowlist/Exclusion**:
    - Add a list of known false positive values or patterns to ignore.
    - Ignore matches that look like URLs or file paths.
4. **Context Awareness**:
    - Skip lines that look like comments (if easy) or documentation.

## Implementation Details

- Modify `src/fetchext/secrets.py`.
- Add `math` import for entropy calculation.
- Update `_scan_content` to filter candidates.

## Verification

- Create a test file with known false positives (placeholders, low entropy strings).
- Verify that `scan_extension` ignores them but still catches real secrets.
