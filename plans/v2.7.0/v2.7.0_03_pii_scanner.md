# Plan: PII Scanner

## 1. Introduction

Extensions often collect user data. We need a scanner to detect potential Personally Identifiable Information (PII) collection or leakage in the source code.

## 2. Objectives

- Add `fext scan --pii <file>` (or integrate into `analyze`).
- Detect keywords and patterns associated with PII (email, phone, credit card, address, ssn, etc.).

## 3. Implementation Details

### 3.1. Regex Patterns

Define a set of regexes in `src/fetchext/analysis/pii.py`:

- **Email**: Variable names or string literals resembling email patterns.
- **Phone**: Patterns for phone numbers.
- **Credit Card**: Luhn algorithm check or regex for CC numbers (careful with false positives).
- **Keywords**: "password", "secret", "token" (overlap with secret scanner?), "dob", "social security", "credit card".

### 3.2. Integration

- Create `PIIScanner` class implementing the scanner interface.
- Integrate into the `AnalysisEngine`.
- Add CLI flag `--pii` to `fext scan` or `fext analyze`.

### 3.3. Reporting

- Include PII findings in the JSON and HTML reports.
- Highlight the file and line number.

## 4. Verification

- **Test Data**: Create a dummy extension with variables like `user_email`, `credit_card_number`, and hardcoded phone numbers.
- **Assert**: The scanner detects these items and reports them correctly.
