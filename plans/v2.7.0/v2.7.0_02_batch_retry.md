# Plan: Batch Retry Logic

## 1. Introduction

Currently, `fext batch` (or bulk operations) can fail partially, leaving the user to manually figure out which extensions failed. We need a robust retry mechanism that generates a "retry list" file.

## 2. Objectives

- Improve `fext batch` resilience.
- Generate a `failed_downloads.txt` (or similar) upon partial failure.
- Allow `fext batch` to accept this failure file as input for retries.

## 3. Implementation Details

### 3.1. Failure Tracking

- In `BatchDownloader` (or equivalent logic), catch exceptions per extension.
- Log failures to a list `failed_items`.

### 3.2. Output Generation

- If `failed_items` is not empty at the end of the run:
  - Write the list of IDs/URLs to `failed_downloads_<timestamp>.txt`.
  - Print a clear message to the user: "X downloads failed. Retry with: fext batch failed_downloads_....txt".

### 3.3. Input Handling

- Ensure `fext batch` (and `mirror`) can parse this simple text file format (one ID/URL per line), which it likely already does, but verify edge cases (comments, empty lines).

## 4. Verification

- **Test Case**: Simulate network failures for specific IDs in a batch of 10.
- **Assert**:
  - The process completes for successful ones.
  - A failure file is created containing only the failed IDs.
  - Running `fext batch` on that file attempts to download them again.
