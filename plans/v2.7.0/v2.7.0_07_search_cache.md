# Plan: Enhanced Search Cache

## 1. Introduction

`fext search` queries the Web Store API. Repeated searches for the same term are slow and wasteful.

## 2. Objectives

- Implement a TTL-based cache for search results.
- Store results in a local cache (SQLite or JSON).

## 3. Implementation Details

### 3.1. Cache Storage

- Use the existing SQLite DB (`history.db`) or a new `cache.db`.
- Table: `search_cache (query_hash, json_result, timestamp)`.

### 3.2. Logic

- **On Search**:
  - Hash the query (browser + term).
  - Check DB for valid entry (e.g., < 24 hours old).
  - If hit: return cached JSON.
  - If miss: query Web Store, save result to DB.
- **Invalidation**: `fext clean` should clear this cache.

### 3.3. Config

- Add `cache_ttl` to `config.toml` (default: 86400 seconds).

## 4. Verification

- **Test**: Run `fext search "adblock"`. Measure time. Run again immediately.
- **Assert**: Second run is near-instant and does not hit network (mock network to verify).
