# Plan: Repository Statistics (v0.9.0)

## Goal

Implement `fext stats <directory>` to provide insights into a local collection of extensions.

## Features

1. **General Stats**: Total count, total size (disk usage).
2. **Manifest Versions**: Breakdown of MV2 vs MV3.
3. **Permission Analysis**: Top 10 most common permissions.
4. **File Types**: Breakdown of file extensions inside the archives (e.g., .js, .html, .png).
5. **Visualization**: Use `rich` tables and bar charts for display.

## Implementation Details

### 1. `src/fetchext/stats.py`

- `class RepoAnalyzer`:
  - `scan(directory: Path) -> RepoStats`: Iterates over CRX/ZIP files.
  - `analyze_file(path: Path) -> FileStats`: Extracts metadata from a single file.
- `class RepoStats`:
  - Dataclass to hold aggregated data.

### 2. `src/fetchext/cli.py`

- Add `stats` subcommand.
- Arguments:
  - `directory`: Path to scan (default: current dir).
  - `--json`: Output raw JSON instead of TUI.

### 3. Tests

- `tests/unit/test_stats.py`:
  - Mock file system with dummy CRX files.
  - Verify aggregation logic.

## Verification

- Run `fext stats downloads/` and check output.
- Run `fext stats --json downloads/` and check JSON.
